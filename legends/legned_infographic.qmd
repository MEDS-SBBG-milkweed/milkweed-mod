---
title: "Infographic Legends for habitat suitability maps and site accessibility indices"
---

```{r}
library(tidyverse)
library(leaflet)
```

# Suitability model Legend

```{r}
rasCols <- c("#2c7bb6", "#abd9e9", "#ffffbf", "#fdae61", "#d7191c")

legend_df <- tibble(pos = c(0, 1, 2, 3, 4),
                    suitability = c("0","0.25","0.5","0.75","1"))

legend <- ggplot(data = legend_df) + 
  
  # add equal height/width rectangles to the plot, using the pos column to designate each position on the x axis. Each rectangle is filled with a color based on the continent ----
  geom_rect(aes(xmin = pos, xmax = pos + 1, 
                ymin = 0.35, ymax = 0.55, fill = suitability), size = 6) + 
  
  # Add continent labels in the center bottom of each rectangle in oswald, white, size 6, bold text ----
  geom_text(aes(x = pos + 0.5, y = 0.425, label = suitability), 
            family = "oswald", color = "black", size = 5, 
            hjust = 0.5, vjust = 0, fontface = "bold") + 
  
  # add arrows and annotations
  # right arrow
  annotate(
    geom = "curve",
    x = 5.5, xend = 4.8,
    y = .55, yend = .55,
    curvature = 0.6,
    arrow = arrow(length = unit(0.3, "cm")),
    linewidth = 1,
    color = "black"
  ) +
  # label right arrow (high suitability)
  annotate(
    geom = "text",
    x = 5.1, y = .45,
    label = "A value of 1 indicates high \npredicted suitability, therefore \nit is very likely to find \nmilkweed in locations colored red",
    color = "black",
    size = 3,
    family = "oswald",
    #fontface = 2,
    hjust = "outward"
  ) +
  # left arrow
  annotate(
    geom = "curve",
    x = -.5, xend = 0.2,
    y = .35, yend = .35,
    curvature = 0.6,
    arrow = arrow(length = unit(0.3, "cm")),
    linewidth = 1,
    color = "black"
  ) +
  # label left arrow (low suitability)
  annotate(
    geom = "text",
    x = -0.1, y = .45,
    label = "A value of 0 indicates low \npredicted suitability, \ntherefore it is NOT likely to find \nmilkweed in locations colored blue",
    color = "black",
    size = 3,
    family = "oswald",
    #fontface = 2,
    hjust = "outward"
  ) +
  # manually set the color scale for the rectangles to the reverse of the previously defined color palette ----
  scale_fill_manual(values = rasCols) +
  
  # set the limits of the y axis to be continuous from 0 to 1. set the limits of the x axis to be continuous from 0 to 9  ----
  scale_y_continuous(limits = c(0,1)) + 
  scale_x_continuous(limits = c(-3,8)) + 
  
  # remove any and all legends ----
  guides(color = "none", fill = "none") + 
  
  # add the theme "void" to remove axis labels, lines, tickmarks, and grid lines ----
  theme_void() 

legend
```

# Accessibility Legend

```{r}
pal_access <- (scales::viridis_pal(option = "plasma")(5))

legend_df <- tibble(pos = c(0, 1, 2, 3, 4),
                    accessibility = c("0","0.25","0.5","0.75","1"))

legend <- ggplot(data = legend_df) + 
  
  # add equal height/width rectangles to the plot, using the pos column to designate each position on the x axis. Each rectangle is filled with a color based on the continent ----
  geom_rect(aes(xmin = pos, xmax = pos + 1, 
                ymin = 0.35, ymax = 0.55, fill = accessibility), size = 6) + 
  
  # Add continent labels in the center bottom of each rectangle in oswald, white, size 6, bold text ----
  geom_text(aes(x = pos + 0.5, y = 0.425, label = accessibility), 
            family = "oswald", color = "black", size = 5, 
            hjust = 0.5, vjust = 0, fontface = "bold") + 
  
  # add arrows and annotations
  # right arrow
  annotate(
    geom = "curve",
    x = 5.5, xend = 4.8,
    y = .55, yend = .55,
    curvature = 0.6,
    arrow = arrow(length = unit(0.3, "cm")),
    linewidth = 1,
    color = "black"
  ) +
  # label right arrow (high suitability)
  annotate(
    geom = "text",
    x = 5.1, y = .45,
    label = "A value of 1 indicates high \naccessibility, therefore \nit should be easier for \nresearchers to access yellow sites",
    color = "black",
    size = 3,
    family = "oswald",
    #fontface = 2,
    hjust = "outward"
  ) +
  # left arrow
  annotate(
    geom = "curve",
    x = -.5, xend = 0.2,
    y = .35, yend = .35,
    curvature = 0.6,
    arrow = arrow(length = unit(0.3, "cm")),
    linewidth = 1,
    color = "black"
  ) +
  # label left arrow (low suitability)
  annotate(
    geom = "text",
    x = -0.1, y = .45,
    label = "A value of 0 indicates low \naccessibility, therefore it should \nbe difficult for researchers to \naccess dark blue sites",
    color = "black",
    size = 3,
    family = "oswald",
    #fontface = 2,
    hjust = "outward"
  ) +
  # manually set the color scale for the rectangles to the reverse of the previously defined color palette ----
  scale_fill_manual(values = pal_access) +
  
  # set the limits of the y axis to be continuous from 0 to 1. set the limits of the x axis to be continuous from 0 to 9  ----
  scale_y_continuous(limits = c(0,1)) + 
  scale_x_continuous(limits = c(-3,8)) + 
  
  # remove any and all legends ----
  guides(color = "none", fill = "none") + 
  
  # add the theme "void" to remove axis labels, lines, tickmarks, and grid lines ----
  theme_void() 

legend
```

# Priority Legend

```{r}
pal_priority <- scales::viridis_pal(option = "C", begin = 0, end = 1)(5)

legend_df <- tibble(pos = c(0, 1, 2, 3, 4),
                    accessibility = c("0","0.25","0.5","0.75","1"))

legend <- ggplot(data = legend_df) + 
  
  # add equal height/width rectangles to the plot, using the pos column to designate each position on the x axis. Each rectangle is filled with a color based on the continent ----
  geom_rect(aes(xmin = pos, xmax = pos + 1, 
                ymin = 0.35, ymax = 0.55, fill = accessibility), size = 6) + 
  
  # Add continent labels in the center bottom of each rectangle in oswald, white, size 6, bold text ----
  geom_text(aes(x = pos + 0.5, y = 0.425, label = accessibility), 
            family = "oswald", color = "black", size = 5, 
            hjust = 0.5, vjust = 0, fontface = "bold") + 
  
  # add arrows and annotations
  # right arrow
  annotate(
    geom = "curve",
    x = 5.5, xend = 4.8,
    y = .55, yend = .55,
    curvature = 0.6,
    arrow = arrow(length = unit(0.3, "cm")),
    linewidth = 1,
    color = "black"
  ) +
  # label right arrow (high suitability)
  annotate(
    geom = "text",
    x = 5.1, y = .45,
    label = "A value of 1 indicates high priority, \ntherefore these survey\nsites are very accessible and \nhave a high predicted suitability \nfor the specified milkweed species",
    color = "black",
    size = 3,
    family = "oswald",
    #fontface = 2,
    hjust = "outward"
  ) +
  # left arrow
  annotate(
    geom = "curve",
    x = -.5, xend = 0.2,
    y = .35, yend = .35,
    curvature = 0.6,
    arrow = arrow(length = unit(0.3, "cm")),
    linewidth = 1,
    color = "black"
  ) +
  # label left arrow (low suitability)
  annotate(
    geom = "text",
    x = -0.1, y = .45,
    label = "A value of 0 indicates low priority, \ntherefore these survey\nsites are not accessible and \nhave a low predicted suitability \nfor the specified milkweed species",
    color = "black",
    size = 3,
    family = "oswald",
    #fontface = 2,
    hjust = "outward"
  ) +
  # manually set the color scale for the rectangles to the reverse of the previously defined color palette ----
  scale_fill_manual(values = pal_priority) +
  
  # set the limits of the y axis to be continuous from 0 to 1. set the limits of the x axis to be continuous from 0 to 9  ----
  scale_y_continuous(limits = c(0,1)) + 
  scale_x_continuous(limits = c(-3,8)) + 
  
  # remove any and all legends ----
  guides(color = "none", fill = "none") + 
  
  # add the theme "void" to remove axis labels, lines, tickmarks, and grid lines ----
  theme_void() 

legend
```
